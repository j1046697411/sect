# 宗门修真录 - 核心玩法设计文档

> 本文档记录游戏核心玩法的设计决策，包括 AI 角色系统、门派任务和交易所系统。

---

## 1. AI 角色系统

### 1.1 决策方式

**目标导向 (GOAP)**

AI 角色根据目标进行规划，选择最优行动序列来实现目标。

### 1.2 目标来源

| 来源 | 优先级 | 说明 |
|------|--------|------|
| 自主目标 | 高 | AI 根据自身需求（修炼、吃饭、社交）主动设定 |
| 门派任务 | 低 | 玩家发布的任务，弟子可选择接受 |

### 1.3 差异化机制

#### 性格参数

| 性格类型 | 倾向 |
|----------|------|
| 勤奋型 | 倾向于修炼，休息少 |
| 保守型 | 倾向于低风险任务 |
| 冒险型 | 倾向于高风险高回报 |
| 社交型 | 倾向于交流、交易 |
| 懒惰型 | 经常休息，效率低 |

**表示方式**：权重数值（总和为 1.0）
```kotlin
data class Personality(
    val diligence: Float = 0.2f,    // 勤奋
    val cautious: Float = 0.2f,     // 保守
    val adventurous: Float = 0.2f,   // 冒险
    val sociable: Float = 0.2f,     // 社交
    val lazy: Float = 0.2f          // 懒惰
)
```

#### 性格对决策的影响

1. **目标权重** - 选择任务时，性格影响各目标的权重
2. **行为微调** - 同样目标，不同性格有不同的执行方式

### 1.4 经历影响

| 维度 | 说明 |
|------|------|
| 成功/失败记忆 | 完成任务的成功/失败经历影响后续选择 |
| 情感关系 | 与其他弟子的关系影响互动 |
| 擅长领域 | 某类任务经验值越高，越倾向选择 |

#### 擅长领域

- **经验值**：每完成一次某类任务，经验+1
- **难度加成**：难度越高的任务，经验越多

---

## 2. 门派任务

### 2.1 任务类型

| 类型 | 说明 | 示例 |
|------|------|------|
| 资源任务 | 采集、炼丹、炼器 | 采集灵草、炼制丹药 |
| 修炼任务 | 闭关、论道、切磋 | 与同门论道 |
| 外交任务 | 探访其他宗门 | 外出交流 |
| 建设任务 | 建造、维护设施 | 修缮殿堂 |

### 2.2 任务流程

```
掌门发布 → 弟子查看 → 主动接受 → 执行任务 → 提交奖励
```

### 2.3 任务发布

- **发布者**：掌门/长老
- **发布方式**：手动发布

### 2.4 任务接取

- **接取方式**：弟子主动查看并选择接受任务

### 2.5 任务奖励

| 奖励类型 | 说明 |
|----------|------|
| 贡献点 | 门派贡献，可兑换资源 |
| 灵石 | 游戏货币 |
| 物品 | 随机物品奖励 |

### 2.6 任务失败

- **惩罚**：扣除贡献点

---

## 3. 交易所系统

### 3.1 交易模式

**寄卖模式** - 弟子通过交易所挂单，不直接交易

### 3.2 寄卖流程

```
弟子挂单 → 设置物品和价格 → 系统给出参考价 → 弟子调整价格 → 上架等待 → 被购买
```

### 3.3 定价机制

- **系统参考价**：根据物品价值给出参考价格
- **弟子调整**：可在参考价一定范围内调整

### 3.4 搜购流程

```
弟子搜购 → 设置物品和价位 → 系统匹配 → 购买成功
```

### 3.5 支持物品

| 类型 | 示例 |
|------|------|
| 装备 | 武器、防具 |
| 材料 | 炼丹、炼器材料 |
| 功法 | 功法秘籍 |
| 丹药 | 炼制的丹药 |

---

## 4. 经济系统

### 4.1 闭环设计

所有物品都不会无故产生或消失

### 4.2 物品产出

| 来源 | 说明 |
|------|------|
| 采集 | 弟子去采集药材、矿物 |
| 炼制 | 炼丹、炼器产出 |
| 种植 | 药园种植产出 |
| 击杀 | 外出历练获得 |

---

## 5. 待细化内容

以下内容在当前版本中暂不讨论，留待后续迭代：

1. **学习系统** - AI 从经验中学习，第一版暂不做
2. **交流系统** - 弟子之间的日常对话、关系建立
3. **传承系统** - 功法、技艺的师徒传承、遗产继承
4. **外交任务** - 探访其他宗门

---

## 6. 文档变更记录

| 日期 | 变更说明 |
|------|----------|
| 2026-02-16 | 初始版本，记录 AI 角色系统、门派任务、交易所系统设计 |
